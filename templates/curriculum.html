{% extends "base.html" %}
{% block title %}Curriculum & Syllabus • Computer Science Department{% endblock %}

{% block content %}
<section class="container mt-4 mb-5 curriculum-page">


    <!-- PAGE HEADER -->
    <div class="text-center mb-4">
        <h2 class="section-title">Curriculum & Syllabus</h2>
        <p class="text-muted">
            Department of Computer Science – Undergraduate and Postgraduate Programs
        </p>
    </div>

    <!-- INTRO TEXT -->
    <div class="mb-4">
        <p>
            The curriculum of the Computer Science Department is designed in accordance
            with NEP guidelines and outcome-based education. It emphasizes strong
            theoretical foundations, practical skills, and industry relevance.
        </p>
    </div>

    <!-- TABLE -->
    <div class="table-responsive">
        <table class="table table-bordered align-middle curriculum-table">
            <thead class="table-primary text-center">
                <tr>
                    <th>Degree / Class</th>
                    <th>2024-25</th>
                    <th>2023-24</th>
                </tr>
            </thead>
            <tbody id="curriculumTableBody">
                <!-- rows will be inserted -->
            </tbody>
        </table>
    </div>

</section>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", function () {

        fetch("/api/curriculum")
            .then(res => res.json())
            .then(data => {

                const tbody = document.getElementById("curriculumTableBody");
                tbody.innerHTML = "";

                if (!data || data.length === 0) {
                    tbody.innerHTML = `
          <tr>
            <td colspan="3" class="text-center text-muted">
              No curriculum uploaded yet.
            </td>
          </tr>`;
                    return;
                }

                // group data by degree
                const grouped = {};
                data.forEach(item => {
                    if (!grouped[item.degree]) {
                        grouped[item.degree] = {};
                    }
                    grouped[item.degree][item.year] = item.pdf_url;
                });

                Object.keys(grouped).forEach(deg => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
          <td>${deg}</td>
          <td class="text-center">
            ${grouped[deg]["2024-25"]
                            ? `<a href="${grouped[deg]["2024-25"]}" target="_blank" class="btn btn-sm btn-outline-primary">View</a>`
                            : "--"}
          </td>
          <td class="text-center">
            ${grouped[deg]["2023-24"]
                            ? `<a href="${grouped[deg]["2023-24"]}" target="_blank" class="btn btn-sm btn-outline-primary">View</a>`
                            : "--"}
          </td>
        `;
                    tbody.appendChild(row);
                });

            })
            .catch(err => console.error("Curriculum load error:", err));

    });
</script>

{% endblock %}